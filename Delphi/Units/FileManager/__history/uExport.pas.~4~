unit uExport;

interface
uses
  uBase, Vcl.Graphics, Vcl.ExtCtrls, uAdditionalTypes, uConstants;

procedure SaveBMPFile(const ABlock: TBlock; const AFileName: string);
implementation

  procedure SaveBMPFile(const ABlock: TBlock; const AFileName: string);
  var
    VisibleImageRect: TVisibleImageRect;
  begin
    with TBitMap.Create do
    begin
      Width := ABlock.XLast + SchemeIndent;
      Height := ABlock.Statements[ABlock.Statements.Count - 1].GetYBottom;

      VisibleImageRect.FTopLeft.X := 0;
      VisibleImageRect.FTopLeft.Y := 0;
      VisibleImageRect.FBottomRight.X := Width;
      VisibleImageRect.FBottomRight.Y := Height;

      ABlock.InstallCanvas(Canvas);
      ABlock.DrawBlock(VisibleImageRect);

      SaveToFile(AFileName);
      Destroy;
    end;
  end;

end.
