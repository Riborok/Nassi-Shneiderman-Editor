unit frmHelp;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.Menus, Vcl.OleCtrls, SHDocVw;

type
  THelp = class(TForm)
    WebBrowser: TWebBrowser;
    pmHtmlMenu: TPopupMenu;
    pmiClose: TMenuItem;
    procedure pmiCloseClick(Sender: TObject);
  private
    procedure WMMouseActivate(var Msg: TMessage); message WM_MOUSEACTIVATE;
  public
    procedure Show(AName: WideString);
  end;

var
  Help: THelp;

implementation

{$R *.dfm}

  procedure THelp.WMMouseActivate(var Msg: TMessage);
  begin
    try
      inherited;
      if Msg.LParamHi = 516 then
      pmHtmlMenu.Popup(Mouse.CursorPos.x, Mouse.CursorPos.y);
      Msg.Result := 0;
    except
    end;
  end;

  procedure THelp.pmiCloseClick(Sender: TObject);
  begin
    Close;
  end;

  procedure THelp.Show(AName: WideString);
  var
    Flags, TargetFrameName, PostData, Headers: OleVariant;
  begin
    Caption := AName;
    WebBrowser.Navigate('res://' + Application.ExeName + '/' + AName,
                        Flags, TargetFrameName, PostData, Headers);
    ShowModal;
  end;

end.
